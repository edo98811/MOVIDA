% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/9main_data_dde.R
\docType{class}
\name{MovidaModel}
\alias{MovidaModel}
\title{MovidaData}
\description{
An R6 class for managing and analyzing multi-omics data.
}
\details{
The \code{MovidaModel} class provides methods for initializing, processing,
and retrieving relationships and data from proteomics, transcriptomics,
and metabolomics experiments. It supports parallel processing and
includes functionality for filtering and retrieving data based on
specific criteria.
}
\section{Imports}{

This class requires the following functions and packages:
\itemize{
\item \code{R6::R6Class}
\item \code{SummarizedExperiment::SummarizedExperiment}, \code{rowData}, \code{colData}, \code{assay}
\item \code{future::plan}, \code{future::multisession}, \code{future::sequential}
\item \code{parallel::detectCores}
\item \code{readRDS}, \code{saveRDS}
\item Internal functions: \code{build_inchi_relationships}, \code{build_uniprot_to_ensembl}, \code{check_movida_list}, \code{check_ensembl}, \code{check_inchi}, \code{check_uniprot}
}
}

\section{Private Fields}{

\describe{
\item{dde_prot}{SummarizedExperiment object for proteomics data.}
\item{dde_trans}{SummarizedExperiment object for transcriptomics data.}
\item{dde_metabo}{SummarizedExperiment object for metabolomics data.}
\item{inchi_to_ensembl}{Relationships between InChI and Ensembl IDs.}
\item{inchi_to_uniprot}{Relationships between InChI and UniProt IDs.}
\item{uniprot_to_ensembl}{Relationships between UniProt and Ensembl IDs.}
\item{organism}{Organism information for the data.}
}
}

\section{Public Methods}{

The class provides a suite of methods for interacting with the data model.
\itemize{
\item \code{initialize(movida_list)}: Initializes the object with input data for proteomics, transcriptomics,
and metabolomics, along with associated differential analysis and enrichment results.
\item \code{build_relationships()}: Constructs feature mappings between omics layers using InChI, UniProt,
and Ensembl identifiers, with support for parallel processing.
\item \code{load_relationships(folder_path)}: Loads previously saved relationship data from disk.
\item \code{save_relationships(folder_path)}: Saves current feature relationship data to disk for reuse.
\item \code{get_contrasts()}: Returns a list of available contrasts (comparisons) in the analysis.
\item \code{getDEA(target, contrast, FDRpvalue = NULL, FDRadj = NULL)}: Retrieves differential expression results
for the given data target and contrast, with optional FDR-based filtering.
\item \code{getFEA(target, contrast, FDRpvalue = NULL, FDRadj = NULL)}: Retrieves functional enrichment analysis results
for the specified target and contrast, with optional filtering.
\item \code{get_values_all(target, return_se = FALSE)}: Returns all assay data (or \code{SummarizedExperiment} object)
for the selected data target.
\item \code{get_valuesfeatures(features, source = NULL)}: Retrieves expression data for specific features.
\item \code{get_values_group(groups, source)}: Returns data for specified experimental groups.
\item \code{get_values_samples(samples, source)}: Returns data for specific sample IDs.
\item \code{get_relatedfeatures(feature, target)}: Maps a feature identifier (e.g., InChI, UniProt, Ensembl)
to its related identifiers in other omics layers.
\item \code{get_inchi_to_ensembl()}, \code{get_inchi_to_uniprot()}, \code{get_uniprot_to_ensembl()}: Accessors for relationship mappings
generated during the \code{build_relationships()} phase.
}
}

\examples{
# Example usage:
movida_list <- list(
  results_prot = list(),
  results_trans = list(),
  results_metabo = list(),
  dde_prot = NULL,
  dde_trans = NULL,
  dde_metabo = NULL,
  organism = "Hs"
)
model <- MovidaModel$new(movida_list)

## ------------------------------------------------
## Method `MovidaModel$load_relationships`
## ------------------------------------------------

relationships <- load_relationships("path/to/relationships_folder")
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-MovidaModel-new}{\code{MovidaModel$new()}}
\item \href{#method-MovidaModel-build_relationships}{\code{MovidaModel$build_relationships()}}
\item \href{#method-MovidaModel-get_contrasts}{\code{MovidaModel$get_contrasts()}}
\item \href{#method-MovidaModel-load_relationships}{\code{MovidaModel$load_relationships()}}
\item \href{#method-MovidaModel-save_relationships}{\code{MovidaModel$save_relationships()}}
\item \href{#method-MovidaModel-get_inchi_to_ensembl}{\code{MovidaModel$get_inchi_to_ensembl()}}
\item \href{#method-MovidaModel-get_inchi_to_uniprot}{\code{MovidaModel$get_inchi_to_uniprot()}}
\item \href{#method-MovidaModel-get_uniprot_to_ensembl}{\code{MovidaModel$get_uniprot_to_ensembl()}}
\item \href{#method-MovidaModel-getDEA}{\code{MovidaModel$getDEA()}}
\item \href{#method-MovidaModel-getFEA}{\code{MovidaModel$getFEA()}}
\item \href{#method-MovidaModel-get_values_all}{\code{MovidaModel$get_values_all()}}
\item \href{#method-MovidaModel-get_relatedfeatures}{\code{MovidaModel$get_relatedfeatures()}}
\item \href{#method-MovidaModel-get_valuesfeatures}{\code{MovidaModel$get_valuesfeatures()}}
\item \href{#method-MovidaModel-get_pathwayfeatures}{\code{MovidaModel$get_pathwayfeatures()}}
\item \href{#method-MovidaModel-get_values_subset_metadata}{\code{MovidaModel$get_values_subset_metadata()}}
\item \href{#method-MovidaModel-get_values_samples}{\code{MovidaModel$get_values_samples()}}
\item \href{#method-MovidaModel-get_features_all}{\code{MovidaModel$get_features_all()}}
\item \href{#method-MovidaModel-get_metadata_columns}{\code{MovidaModel$get_metadata_columns()}}
\item \href{#method-MovidaModel-get_metadata}{\code{MovidaModel$get_metadata()}}
\item \href{#method-MovidaModel-clone}{\code{MovidaModel$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-new"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-new}{}}}
\subsection{Method \code{new()}}{
Initialize the MovidaModel object with data.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$new(movida_list)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{movida_list}}{A list containing the data for proteomics, transcriptomics, and metabolomics.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-build_relationships"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-build_relationships}{}}}
\subsection{Method \code{build_relationships()}}{
Funtion to build the relationships datasetss
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$build_relationships()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_contrasts"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_contrasts}{}}}
\subsection{Method \code{get_contrasts()}}{
Unify all the contrasts from the movida_list components.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_contrasts()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A character vector of unique contrast names found across the specified elements of \code{movida_list}.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-load_relationships"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-load_relationships}{}}}
\subsection{Method \code{load_relationships()}}{
Load Relationships from Folder
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$load_relationships(folder_path)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{folder_path}}{Character string specifying the path to the folder containing relationship data files.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns a data.frame containing the loaded relationships.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{relationships <- load_relationships("path/to/relationships_folder")
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-save_relationships"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-save_relationships}{}}}
\subsection{Method \code{save_relationships()}}{
Save relationships between features to disk.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$save_relationships(folder_path)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{folder_path}}{Path to the folder where relationships will be saved.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns nothing. Saves relationship data as RDS files.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_inchi_to_ensembl"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_inchi_to_ensembl}{}}}
\subsection{Method \code{get_inchi_to_ensembl()}}{
Get mapping from InChI to Ensembl.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_inchi_to_ensembl()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Returns a data frame with InChI to Ensembl relationships.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_inchi_to_uniprot"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_inchi_to_uniprot}{}}}
\subsection{Method \code{get_inchi_to_uniprot()}}{
Get mapping from InChI to UniProt.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_inchi_to_uniprot()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Returns a data frame with InChI to UniProt relationships.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_uniprot_to_ensembl"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_uniprot_to_ensembl}{}}}
\subsection{Method \code{get_uniprot_to_ensembl()}}{
Get mapping from UniProt to Ensembl.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_uniprot_to_ensembl()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Returns a data frame with UniProt to Ensembl relationships.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-getDEA"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-getDEA}{}}}
\subsection{Method \code{getDEA()}}{
Get differential expression analysis results.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$getDEA(source, contrast, FDRpvalue = NULL, FDRadj = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{source}}{Data source: "proteomics", "transcriptomics", or "metabolomics".}

\item{\code{contrast}}{Contrast name.}

\item{\code{FDRpvalue}}{Optional FDR p-value threshold.}

\item{\code{FDRadj}}{Optional FDR adjusted value threshold.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns a data frame of DEA results filtered by FDR thresholds.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-getFEA"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-getFEA}{}}}
\subsection{Method \code{getFEA()}}{
Get functional enrichment analysis results.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$getFEA(source, contrast, FDRpvalue = NULL, FDRadj = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{source}}{Data source: "proteomics", "transcriptomics", or "metabolomics".}

\item{\code{contrast}}{Contrast name.}

\item{\code{FDRpvalue}}{Optional FDR p-value threshold.}

\item{\code{FDRadj}}{Optional FDR adjusted value threshold.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns a data frame of FEA results filtered by FDR thresholds.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_values_all"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_values_all}{}}}
\subsection{Method \code{get_values_all()}}{
Get all values from the specified source.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_values_all(source, return_se = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{source}}{Data source: "proteomics", "transcriptomics", or "metabolomics".}

\item{\code{return_se}}{If TRUE, returns the SummarizedExperiment object; otherwise returns assay data.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns assay data or SummarizedExperiment object.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_relatedfeatures"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_relatedfeatures}{}}}
\subsection{Method \code{get_relatedfeatures()}}{
Get related features across omics types.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_relatedfeatures(feature, target)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{feature}}{feature identifier (Ensembl, InChI, or UniProt).}

\item{\code{target}}{Target omics type: "proteomics", "transcriptomics", or "metabolomics".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns related features in the target omics type.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_valuesfeatures"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_valuesfeatures}{}}}
\subsection{Method \code{get_valuesfeatures()}}{
Get values for specified features.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_valuesfeatures(features, source, return_se = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{features}}{Vector of feature identifiers.}

\item{\code{source}}{Data source: "proteomics", "transcriptomics", or "metabolomics".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns assay data for the specified features.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_pathwayfeatures"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_pathwayfeatures}{}}}
\subsection{Method \code{get_pathwayfeatures()}}{
Get features associated with a pathway.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_pathwayfeatures(pathway, contrast, source)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{pathway}}{Pathway name.}

\item{\code{contrast}}{Contrast name.}

\item{\code{source}}{Data source: "proteomics", "transcriptomics", or "metabolomics".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns a vector of feature identifiers in the pathway.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_values_subset_metadata"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_values_subset_metadata}{}}}
\subsection{Method \code{get_values_subset_metadata()}}{
Get values for a subset of samples based on metadata.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_values_subset_metadata(
  subset,
  source,
  column = "group",
  return_se = FALSE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{subset}}{Vector of group names to subset.}

\item{\code{source}}{Data source: "proteomics", "transcriptomics", or "metabolomics".}

\item{\code{column}}{Metadata column to use for subsetting.}

\item{\code{return_se}}{If TRUE, returns the SummarizedExperiment object; otherwise returns assay data.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns assay data or SummarizedExperiment object for the subset.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_values_samples"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_values_samples}{}}}
\subsection{Method \code{get_values_samples()}}{
Get values for specified samples.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_values_samples(samples, source, return_se = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{samples}}{Vector of sample names.}

\item{\code{source}}{String: "proteomics", "transcriptomics", or "metabolomics".}

\item{\code{return_se}}{Bool: whether to return a SummarizedExperiment object or just the assay data.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns SummarizedExperiment object for the specified samples.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_features_all"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_features_all}{}}}
\subsection{Method \code{get_features_all()}}{
Get list of features for a source.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_features_all(source)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{source}}{Data source: "proteomics", "transcriptomics", or "metabolomics".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns a data frame of feature identifiers.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_metadata_columns"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_metadata_columns}{}}}
\subsection{Method \code{get_metadata_columns()}}{
Get metadata column names for a source.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_metadata_columns(source)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{source}}{Data source: "proteomics", "transcriptomics", or "metabolomics".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns a vector of metadata column names.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-get_metadata"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-get_metadata}{}}}
\subsection{Method \code{get_metadata()}}{
Get metadata for a source.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$get_metadata(source)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{source}}{Data source: "proteomics", "transcriptomics", or "metabolomics".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Returns metadata for the specified source.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-MovidaModel-clone"></a>}}
\if{latex}{\out{\hypertarget{method-MovidaModel-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{MovidaModel$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
